{
    "schemes": ["http"],
    "swagger": "2.0",
    "info": {
        "description": "Mobile AI Coding Monitor & Controller Agent API.\nEnables remote monitoring and control of Claude Code CLI sessions from mobile devices.",
        "title": "cdev-agent API",
        "contact": {
            "name": "Brian Ly",
            "url": "https://github.com/brianly1003/cdev"
        },
        "license": {
            "name": "MIT",
            "url": "https://opensource.org/licenses/MIT"
        },
        "version": "1.0"
    },
    "host": "localhost:8766",
    "basePath": "/",
    "paths": {
        "/api/claude/respond": {
            "post": {
                "description": "Send a response to Claude's interactive prompt or permission request",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "claude"
                ],
                "summary": "Respond to Claude",
                "parameters": [
                    {
                        "description": "Response to send to Claude",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/http.RespondToClaudeRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.RespondToClaudeResponse"
                        }
                    },
                    "400": {
                        "description": "Invalid request",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "409": {
                        "description": "Claude not waiting for input",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "503": {
                        "description": "Claude manager not available",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/api/claude/run": {
            "post": {
                "description": "Spawns a Claude CLI process with the given prompt. Supports session modes: \"new\" (default) or \"continue\" (requires session_id).",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "claude"
                ],
                "summary": "Start Claude CLI",
                "parameters": [
                    {
                        "description": "Prompt and session options",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/http.RunClaudeRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.RunClaudeResponse"
                        }
                    },
                    "400": {
                        "description": "Invalid request",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "409": {
                        "description": "Claude already running",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "503": {
                        "description": "Claude manager not available",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/api/claude/sessions": {
            "get": {
                "description": "GET: Returns a list of available Claude sessions. DELETE: Deletes session(s). Use ?session_id=xxx to delete specific session, or no param to delete all.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "claude"
                ],
                "summary": "List or delete Claude sessions",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Session ID (for DELETE only - if omitted, deletes all sessions)",
                        "name": "session_id",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.SessionsResponse"
                        }
                    },
                    "404": {
                        "description": "Session not found",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Failed to list/delete sessions",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            },
            "delete": {
                "description": "GET: Returns a list of available Claude sessions. DELETE: Deletes session(s). Use ?session_id=xxx to delete specific session, or no param to delete all.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "claude"
                ],
                "summary": "List or delete Claude sessions",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Session ID (for DELETE only - if omitted, deletes all sessions)",
                        "name": "session_id",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.SessionsResponse"
                        }
                    },
                    "404": {
                        "description": "Session not found",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Failed to list/delete sessions",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/api/claude/sessions/messages": {
            "get": {
                "description": "Returns all messages for a specific Claude session",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "claude"
                ],
                "summary": "Get session messages",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Session ID",
                        "name": "session_id",
                        "in": "query",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.SessionMessagesResponse"
                        }
                    },
                    "400": {
                        "description": "Missing session_id",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Session not found",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/api/claude/stop": {
            "post": {
                "description": "Gracefully stops the running Claude CLI process",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "claude"
                ],
                "summary": "Stop Claude CLI",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.StopClaudeResponse"
                        }
                    },
                    "409": {
                        "description": "Claude not running",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "503": {
                        "description": "Claude manager not available",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/api/file": {
            "get": {
                "description": "Returns the content of a file in the repository",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "file"
                ],
                "summary": "Get file content",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Relative path to the file",
                        "name": "path",
                        "in": "query",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.FileContentResponse"
                        }
                    },
                    "400": {
                        "description": "Missing path parameter",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "File not found",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "503": {
                        "description": "Git tracker not available",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/api/git/diff": {
            "get": {
                "description": "Returns the git diff for a specific file or all files if no path is provided",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "git"
                ],
                "summary": "Get git diff",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Relative path to the file (optional, returns all diffs if not provided)",
                        "name": "path",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "All diffs (when path not provided)",
                        "schema": {
                            "$ref": "#/definitions/http.GitDiffAllResponse"
                        }
                    },
                    "404": {
                        "description": "Not a git repository",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Git command failed",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/api/git/status": {
            "get": {
                "description": "Returns the git status of the repository showing modified, added, and deleted files",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "git"
                ],
                "summary": "Get git status",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.GitStatusResponse"
                        }
                    },
                    "404": {
                        "description": "Not a git repository",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Git command failed",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/api/status": {
            "get": {
                "description": "Returns the current status of the cdev-agent including Claude state, connected clients, and repository info",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "status"
                ],
                "summary": "Get agent status",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.StatusResponse"
                        }
                    }
                }
            }
        },
        "/health": {
            "get": {
                "description": "Returns the health status of the agent",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "health"
                ],
                "summary": "Health check",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.HealthResponse"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "http.ErrorResponse": {
            "type": "object",
            "properties": {
                "error": {
                    "type": "string",
                    "example": "Something went wrong"
                },
                "path": {
                    "type": "string",
                    "example": "src/main.ts"
                }
            }
        },
        "http.FileContentResponse": {
            "type": "object",
            "properties": {
                "content": {
                    "type": "string",
                    "example": "console.log('hello');"
                },
                "encoding": {
                    "type": "string",
                    "example": "utf-8"
                },
                "path": {
                    "type": "string",
                    "example": "src/main.ts"
                },
                "size": {
                    "type": "integer",
                    "example": 25
                },
                "truncated": {
                    "type": "boolean",
                    "example": false
                }
            }
        },
        "http.GitDiffAllResponse": {
            "type": "object",
            "properties": {
                "diffs": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/http.GitDiffItem"
                    }
                }
            }
        },
        "http.GitDiffItem": {
            "type": "object",
            "properties": {
                "diff": {
                    "type": "string",
                    "example": "@@ -1,3 +1,4 @@\n+new line"
                },
                "path": {
                    "type": "string",
                    "example": "src/main.ts"
                }
            }
        },
        "http.GitDiffResponse": {
            "type": "object",
            "properties": {
                "diff": {
                    "type": "string",
                    "example": "@@ -1,3 +1,4 @@\n+new line"
                },
                "path": {
                    "type": "string",
                    "example": "src/main.ts"
                }
            }
        },
        "http.GitFileStatus": {
            "type": "object",
            "properties": {
                "is_staged": {
                    "type": "boolean",
                    "example": true
                },
                "is_untracked": {
                    "type": "boolean",
                    "example": false
                },
                "path": {
                    "type": "string",
                    "example": "src/main.ts"
                },
                "status": {
                    "type": "string",
                    "example": "M "
                }
            }
        },
        "http.GitStatusResponse": {
            "type": "object",
            "properties": {
                "files": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/http.GitFileStatus"
                    }
                },
                "repo_name": {
                    "type": "string",
                    "example": "myproject"
                },
                "repo_root": {
                    "type": "string",
                    "example": "/Users/dev/myproject"
                }
            }
        },
        "http.HealthResponse": {
            "type": "object",
            "properties": {
                "status": {
                    "type": "string",
                    "example": "ok"
                },
                "time": {
                    "type": "string",
                    "example": "2024-01-15T10:30:00Z"
                }
            }
        },
        "http.RespondToClaudeRequest": {
            "type": "object",
            "required": [
                "tool_use_id"
            ],
            "properties": {
                "is_error": {
                    "type": "boolean",
                    "example": false
                },
                "response": {
                    "type": "string",
                    "example": "Yes, proceed with the changes"
                },
                "tool_use_id": {
                    "type": "string",
                    "example": "toolu_abc123"
                }
            }
        },
        "http.RespondToClaudeResponse": {
            "type": "object",
            "properties": {
                "status": {
                    "type": "string",
                    "example": "sent"
                },
                "tool_use_id": {
                    "type": "string",
                    "example": "toolu_abc123"
                }
            }
        },
        "http.RunClaudeRequest": {
            "type": "object",
            "required": [
                "prompt"
            ],
            "properties": {
                "mode": {
                    "enum": [
                        "new",
                        "continue"
                    ],
                    "allOf": [
                        {
                            "$ref": "#/definitions/http.SessionMode"
                        }
                    ],
                    "example": "new"
                },
                "prompt": {
                    "type": "string",
                    "example": "Create a hello world function"
                },
                "session_id": {
                    "type": "string",
                    "example": "550e8400-e29b-41d4-a716-446655440000"
                }
            }
        },
        "http.RunClaudeResponse": {
            "type": "object",
            "properties": {
                "pid": {
                    "type": "integer",
                    "example": 12345
                },
                "prompt": {
                    "type": "string",
                    "example": "Create a hello world function"
                },
                "session_id": {
                    "type": "string",
                    "example": "550e8400-e29b-41d4-a716-446655440000"
                },
                "status": {
                    "type": "string",
                    "example": "started"
                }
            }
        },
        "http.SessionInfo": {
            "type": "object",
            "properties": {
                "last_updated": {
                    "type": "string",
                    "example": "2024-01-15T10:30:00Z"
                },
                "message_count": {
                    "type": "integer",
                    "example": 5
                },
                "session_id": {
                    "type": "string",
                    "example": "550e8400-e29b-41d4-a716-446655440000"
                },
                "summary": {
                    "type": "string",
                    "example": "Create a hello world function"
                }
            }
        },
        "http.SessionMessage": {
            "type": "object",
            "properties": {
                "content": {
                    "type": "string",
                    "example": "Create a hello world function"
                },
                "role": {
                    "type": "string",
                    "example": "user"
                },
                "timestamp": {
                    "type": "string",
                    "example": "2024-01-15T10:30:00Z"
                },
                "type": {
                    "type": "string",
                    "example": "user"
                }
            }
        },
        "http.SessionMessagesResponse": {
            "type": "object",
            "properties": {
                "count": {
                    "type": "integer",
                    "example": 10
                },
                "messages": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/http.SessionMessage"
                    }
                },
                "session_id": {
                    "type": "string",
                    "example": "550e8400-e29b-41d4-a716-446655440000"
                }
            }
        },
        "http.SessionMode": {
            "type": "string",
            "enum": [
                "new",
                "continue"
            ],
            "x-enum-varnames": [
                "SessionModeNew",
                "SessionModeContinue"
            ]
        },
        "http.SessionsResponse": {
            "type": "object",
            "properties": {
                "current": {
                    "type": "string",
                    "example": "550e8400-e29b-41d4-a716-446655440000"
                },
                "sessions": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/http.SessionInfo"
                    }
                }
            }
        },
        "http.StatusResponse": {
            "type": "object",
            "properties": {
                "agent_session_id": {
                    "description": "Agent instance ID (generated on startup)",
                    "type": "string",
                    "example": "01ce425c-5b91-4f8a-b8dd-5d14644c3494"
                },
                "claude_state": {
                    "type": "string",
                    "example": "idle"
                },
                "connected_clients": {
                    "type": "integer",
                    "example": 1
                },
                "git_enabled": {
                    "type": "boolean",
                    "example": true
                },
                "is_git_repo": {
                    "type": "boolean",
                    "example": true
                },
                "repo_name": {
                    "type": "string",
                    "example": "myproject"
                },
                "repo_path": {
                    "type": "string",
                    "example": "/Users/dev/myproject"
                },
                "session_id": {
                    "description": "Claude session ID (for continue) - empty if no active session",
                    "type": "string",
                    "example": "550e8400-e29b-41d4-a716-446655440000"
                },
                "uptime_seconds": {
                    "type": "integer",
                    "example": 3600
                },
                "version": {
                    "type": "string",
                    "example": "1.0.0"
                },
                "watcher_enabled": {
                    "type": "boolean",
                    "example": true
                }
            }
        },
        "http.StopClaudeResponse": {
            "type": "object",
            "properties": {
                "status": {
                    "type": "string",
                    "example": "stopped"
                }
            }
        }
    },
    "tags": [
        {
            "description": "Health check endpoints",
            "name": "health"
        },
        {
            "description": "Agent status endpoints",
            "name": "status"
        },
        {
            "description": "Claude CLI management endpoints",
            "name": "claude"
        },
        {
            "description": "Git operations endpoints",
            "name": "git"
        },
        {
            "description": "File operations endpoints",
            "name": "file"
        }
    ]
}